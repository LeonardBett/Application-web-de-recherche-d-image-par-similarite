import{a as v}from"./http-api-NiqjV3eZ.js";import{_ as b}from"./Image.vue_vue_type_script_setup_true_lang-7v1o6ocU.js";import{d as L,r as d,g as f,k as R,i as U,c as u,a as n,t as h,h as w,F as p,b as F,l as _,m as S,n as x,o as m}from"./index-CaroCXY8.js";const C={key:0},E=["src"],M={key:1},A={key:0},B={class:"similar-images-container"},O=L({__name:"QuizzImage",setup(N){const s=d([]),l=d(null),r=d([]),c=d(null),i=d(null),I=async()=>{try{if(s.value=await v.getImageList(),s.value.length>0){const e=Math.floor(Math.random()*s.value.length);l.value=s.value[e].id,l.value===0&&(l.value=1)}}catch(e){console.error("Error fetching image list:",e)}},y=async e=>{try{r.value=await v.getSimilarImages(e),r.value=r.value.slice(0,3)}catch(a){console.error("Error fetching similar images:",a),r.value=[]}},k=async e=>{try{const a=await v.getImageFlou(e),t=s.value.find(o=>o.id===e);t?c.value={blob:a,meta:t}:(console.warn("Image metadata not found for id",e),c.value=null)}catch(a){console.error("Error fetching flou image:",a),c.value=null}};f(c,e=>{i.value&&(URL.revokeObjectURL(i.value),i.value=null),e!=null&&e.blob&&(i.value=URL.createObjectURL(e.blob))}),f(l,async e=>{e!==null?(await y(e),await k(e)):(r.value=[],c.value=null)});const g=R(()=>{if(!l.value)return[];const e=new Set([l.value,...r.value.map(t=>t.id)]);return Array.from(e).map(t=>s.value.find(o=>o.id===t)||{id:t,name:"Unknown"}).sort(()=>Math.random()-.5)});return U(I),(e,a)=>{const t=x("router-link");return m(),u(p,null,[n("div",null,[a[1]||(a[1]=n("h3",null,"Random Image",-1)),l.value!==null&&i.value?(m(),u("div",C,[n("p",null,"Image ID: "+h(l.value),1),n("img",{src:i.value,alt:"Image floue"},null,8,E)])):(m(),u("div",M,a[0]||(a[0]=[n("p",null,"Loading image...",-1)])))]),n("div",null,[g.value.length>0?(m(),u("div",A,[a[2]||(a[2]=n("h4",null,"Images",-1)),n("div",B,[(m(!0),u(p,null,F(g.value,o=>(m(),u("div",{key:o.id,class:"similar-image"},[_(t,{to:{name:"Result",params:{id:o.id===l.value?0:1}}},{default:S(()=>[_(b,{id:o.id},null,8,["id"])]),_:2},1032,["to"]),n("p",null,h(o.name),1)]))),128))])])):w("",!0)])],64)}}});export{O as default};
